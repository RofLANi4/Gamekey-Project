<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gamekey</title>
    {% load static %} {% load discount_counter %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
  </head>
  <body>
    <div class="mask">
      <img src="{% static '/Images/loader.gif' %}" alt="" />
    </div>
    <!--Начало панели навигации-->
    <nav class="nav">
      <div class="nav-content">
        <div class="logo">
          <p><a href="{% url 'game_keys:index' %}">GAMEKEY</a></p>
        </div>
        <div class="nav-list">
          <ul>
            <li class="new">
              <a href="{% url 'game_keys:new_games' %}">Новинки</a>
            </li>
            <li class="discount">
              <a href="{% url 'game_keys:discounts' %}">Знижки</a>
            </li>
            <li class="waiting">
              <a href="{% url 'game_keys:coming_soon' %}">Очікуванні</a>
            </li>
          </ul>
        </div>
        <form id="search-form">
          <div class="input">
            <input type="text" placeholder="Знайти гру..." id="mySearch" name="mySearch" />
            <div class="search">
              <div>
                <img
                  src="{% static '/Images/Search.svg' %}"
                  alt="Search Button"
                />
              </div>
              <div id="search-results"></div>
            </div>
          </div>
        </form>
        <div class="logo-basket">
          <img src="{% static '/Images/Basket.svg' %}" alt="Basket Button" />
        </div>
      </div>
    </nav>
    <!--Конец панели навигации-->

    <div id="slide">
      <div>
        <button id="buttonPrev">
          <img src="../static/Images/Prev.svg" alt="" />
        </button>
      </div>
      <div class="slides">
        <div class="overflow">
          <div class="images">
            {% if random_games %}
            <!-- Images -->
            {% for game in random_games %}
            <!-- Images -->
            {% if forloop.counter0|divisibleby:3%}
            <div class="images-block">
              {% endif %}
              <div>
                <img src="{{ MEDIA_URL }}{{ game.image }}" alt="game image" />
                <p
                  class="price"
                  text="{{ game.price|discount:game.discount }}₴"
                ></p>
              </div>

              {% if forloop.counter|divisibleby:3 or forloop.last %}
            </div>
            <!-- Close the game group div after every third game or if it's the last game -->
            {% endif %} {% endfor %}{% else %}
            <h1 class="images-block">There are no games yet</h1>
            {% endif %}
          </div>
        </div>
      </div>
      <div>
        <button id="buttonNext">
          <img src="../static/Images/Next.svg" alt="" />
        </button>
      </div>
    </div>
    <!--Конец слайдера-->

    <!--Начало нижней панели с играми-->
    {% if random1_games %}
    <div id="gameList">
      <div class="games-column">
        <div class="games-row">
          {% for game in random1_games %}
          <div class="games">
            <div class="info">
              <img src="{{ MEDIA_URL }}{{ game.image }}" alt="" />
              <p class="game-name">{{ game.name }}</p>
              {% if game.discount %}
              <p class="discount-percent">-{{ game.discount }}%</p>
              {% endif %}
              <p
                class="price"
                text="{{ game.price|discount:game.discount }}₴"
              ></p>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
    {% endif %}

    <!--Конец нижней панели с играми-->

    <!--Начало футуера-->
    <footer>
      <div class="container">
        <div class="info-footer">
          <nav>
            <h2>Навігація</h2>
            <ul>
              <li><a href="{% url 'game_keys:new_games' %}">Новинки</a></li>
              <li><a href>Знижки</a></li>
              <li><a href>Очікуванні</a></li>
            </ul>
          </nav>

          <div class="team">
            <h2>Круті хлопці</h2>
            <ul>
              <li>Жовтоватюк Артем</li>
              <li>Журавльов Нікіта</li>
              <li>Приходько Олександр</li>
              <li>
                <a
                  href="https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwjmh8nwv-v-AhWrDRAIHZuDAiQQwqsBegQICRAF&url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DdQw4w9WgXcQ&usg=AOvVaw0aHtehaphMhOCAkCydRLZU"
                  style="color: fff"
                  >Кордунер Кевін</a
                >
              </li>
              <li>Федорчук Дмитро</li>
              <li>Бокучава Олександр</li>
            </ul>
          </div>
          <div class="links-footer">
            <h2>Корисні посилання</h2>
            <ul>
              <li>
                <a
                  href="https://github.com/RofLANi4/Gamekey-Project"
                  target="_blank"
                  >GitHub</a
                >
              </li>
              <li>
                <a
                  href="https://drive.google.com/drive/folders/1yVpAAh5TZGNJV9cSZcerqVP6zl9KvYjG"
                  target="_blank"
                  >DB Files</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div class="policy">
          <p>&copy; GAMEKEY</p>
          <p>University project</p>
        </div>
      </div>
    </footer>
    <!--Конец футуера-->

    <script src="{% static 'js/content.js' %}"></script>
    <script src="{% static 'js/header.js' %}"></script>
    <script src="{% static 'js/loader.js' %}"></script>
    <script src="{% static 'js/slider.js' %}"></script>
    <script>
      function sendSearchRequest() {
        let searchTerm = document.getElementById("mySearch").value;
        let url = "/gamekey/search/?q=" + searchTerm;

        let xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
          if (xhr.readyState === 4 && xhr.status === 200) {
            let results = JSON.parse(xhr.responseText);
            console.log(results); // handle the results here
          }
        };
        xhr.open("GET", url, true);
        xhr.send();
      }

      document.getElementById("mySearch").addEventListener("input", sendSearchRequest);
    </script>
  </body>
</html>
